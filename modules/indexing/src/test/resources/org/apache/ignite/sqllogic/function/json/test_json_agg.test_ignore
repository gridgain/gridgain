# name: test/sql/function/json/test_json_agg.test
# description: Test JSON aggregation functions
# group: [json]
# [ignore] Not supported.

statement ok
CREATE TABLE TEST(ID INT PRIMARY KEY, N VARCHAR, J JSON);

statement ok
INSERT INTO TEST VALUES (1, 'Ten', '10' FORMAT JSON), (2, 'Null', NULL), (3, 'False', 'false' FORMAT JSON)

query R
SELECT JSON_OBJECTAGG(KEY N VALUE J) FROM TEST;
----
{"Ten":10,"Null":null,"False":false}

query R
SELECT JSON_OBJECTAGG(N: J) FROM TEST;
----
{"Ten":10,"Null":null,"False":false}

query R
SELECT JSON_OBJECTAGG(N: J ABSENT ON NULL) FROM TEST;
----
{"Ten":10,"False":false}

query R
SELECT JSON_ARRAYAGG(J NULL ON NULL) FROM TEST;
----
[10,null,false]

query R
SELECT JSON_ARRAYAGG(J) FROM TEST;
----
[10,false]

query R
SELECT JSON_ARRAYAGG(J ABSENT ON NULL) FROM TEST;
----
[10,false]

statement ok
DROP TABLE IF EXISTS TEST